
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>9. Lookbehind and other extra data &#8212; Typped  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="10. APIs and code for the modules in the Typped package" href="typped.html" />
    <link rel="prev" title="8. Parsers calling other parsers" href="parsers_calling_other_parsers.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="typped.html" title="10. APIs and code for the modules in the Typped package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="parsers_calling_other_parsers.html" title="8. Parsers calling other parsers"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Typped  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lookbehind-and-other-extra-data">
<h1>9. Lookbehind and other extra data<a class="headerlink" href="#lookbehind-and-other-extra-data" title="Permalink to this headline">¶</a></h1>
<p>Another minor generalization to Pratt parsing is the use of “lookbehind”
information.  A Pratt parser can use lookahead information from the lexer in
defining preconditions, etc.  In some cases lookbehind information, looking at
the previous <code class="docutils literal"><span class="pre">processed_left</span></code> values for the current subexpression, could be
useful.</p>
<p>This is a simple modification, and is currently implemented.  In the
<code class="docutils literal"><span class="pre">recursive_parse</span></code> function, whenever the <code class="docutils literal"><span class="pre">processed_left</span></code> variable is
assigned a new value, that value is also appended to a list called
<code class="docutils literal"><span class="pre">lookbehind</span></code>.  This list is temporarily set as an attribute of the triggering
token, and so can be accessed as <code class="docutils literal"><span class="pre">tok.extra_data.lookbehind</span></code> in both the
handler functions and in the preconditions functions.</p>
<p>Since the lookbehind tokens have already been processed they allow the
preconditions to make use of information such as resolved type information (not
just token label information).  Of course you could already look at the
<code class="docutils literal"><span class="pre">left</span></code> variable in a tail handler and see the type of the subexpression for,
say, the type of the left operand of an operator.</p>
<p>Note that the <code class="docutils literal"><span class="pre">lookbehind</span></code> list contains references, not copies, and so the
previous values will generally be modified versions of what they were when they
were first appended to the list.  The main thing that the lookbehind list tells
you is how many subexpressions precede the current one at its same level in the
recursion.  In theory, the whole head versus tail distinction could be
eliminated and replaced with preconditions on whether or not the lookbehind
list is empty.  The distinction between head and tail handlers is useful in
practice, however, and so has been kept.</p>
<p>Lookbehind information is not a feature which will be commonly used, but it may
have some use cases.</p>
<p>In addition to lookbehind information, the temporary <code class="docutils literal"><span class="pre">extra_data</span></code> attribute
of a triggering token (which is a namedtuple) contains some other information
which users might want to access.  The current subexpression precedence is
available as <code class="docutils literal"><span class="pre">subexp_prec</span></code>.  Also available is a list <code class="docutils literal"><span class="pre">constructs</span></code> which
contains all the constructs for all the previous sub-subexpressions of the
subexpression.  They are appended just after they are dispatched, and so the
current construct is available in head or tail handler functions.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="parsers_calling_other_parsers.html"
                        title="previous chapter">8. Parsers calling other parsers</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="typped.html"
                        title="next chapter">10. APIs and code for the modules in the Typped package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/lookbehind.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="typped.html" title="10. APIs and code for the modules in the Typped package"
             >next</a> |</li>
        <li class="right" >
          <a href="parsers_calling_other_parsers.html" title="8. Parsers calling other parsers"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Typped  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Allen Barker.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>